buildscript {
  dependencies {
    // figure out how to use local plugin in current sample module
    classpath "com.squareup.wire:wire-gradle-plugin:2.3.0-SNAPSHOT"
  }

  repositories {
    google()
    mavenCentral()
    mavenLocal()
  }
}

repositories {
  mavenLocal()
  mavenCentral()
}

//ext {
//  generatedSourcesDir = "${buildDir}/generated/src/java"
//}
apply plugin: 'application'
apply plugin: 'com.squareup.wire'

mainClassName = 'com.squareup.dinosaurs.Sample'

sourceCompatibility = JavaVersion.VERSION_1_7
targetCompatibility = JavaVersion.VERSION_1_7

jar {
  manifest {
    attributes('Automatic-Module-Name': 'wire-sample')
  }
}

dependencies {
  implementation "com.squareup.wire:wire-runtime:2.3.0-SNAPSHOT"
}

wire {
  protoPaths = files('src/main/proto')
  
  javaTarget = {
    outDirectory = "${buildDir}/generated/src/java"
  }
}

//task generateProtos(type: JavaExec) {
//  classpath = configurations.wire
//  main = 'com.squareup.wire.WireCompiler'
//  args = [
//      '--proto_path=src/main/proto',
//      "--java_out=$generatedSourcesDir"
//  ]
//}

//compileJava {
//  dependsOn generateProtos
//  source generatedSourcesDir
//}